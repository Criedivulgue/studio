rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Regra específica para a coleção 'users'
    match /users/{userId} {
      // Qualquer pessoa pode criar um documento de usuário (se cadastrar)
      allow create: if true;
      
      // Apenas o usuário autenticado pode ler, atualizar ou apagar seus próprios dados
      // O Super Admin (com ID fixo) também pode ter acesso, se necessário (adicionado para flexibilidade)
      allow read, update, delete: if request.auth != null && (request.auth.uid == userId || get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'Super Admin'); 
    }

    // Regra para a coleção 'ai-configs'
    match /ai-configs/{configId} {
        // Apenas o usuário autenticado pode ler/escrever sua própria config ou a config global
        allow read, write: if request.auth != null;
    }

    // Regras para outras coleções podem ser adicionadas aqui.
    // Se nenhuma outra regra corresponder, o acesso é negado por padrão.
  }
}
